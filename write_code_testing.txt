  @override
  void initState() {
    super.initState();
    filteredTemplates = allTemplates;
    _searchController.addListener(_filterTemplates);
  }

  @override
  void dispose() {
    _searchController.removeListener(_filterTemplates);
    _searchController.dispose();
    super.dispose();
  }

  void _filterTemplates() {
    setState(() {
      final query = _searchController.text.toLowerCase();
      final selectedCategory = _tabs[_selectedTabIndex];

      filteredTemplates = allTemplates.where((template) {
        final matchesSearch =
            template.displayName.toLowerCase().contains(query) ||
            template.category.toLowerCase().contains(query);
        final matchesCategory =
            selectedCategory == 'All' || template.category == selectedCategory;
        return matchesSearch && matchesCategory;
      }).toList();
    });
  }